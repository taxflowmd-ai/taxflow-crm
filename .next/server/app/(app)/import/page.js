(()=>{var e={};e.id=215,e.ids=[215],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8525:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(1791),s(3703),s(5866),s(1506);var r=s(3191),a=s(8716),i=s(7922),n=s.n(i),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["(app)",{children:["import",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1791)),"/Users/iongonta/Downloads/taxflow-crm/app/(app)/import/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3703)),"/Users/iongonta/Downloads/taxflow-crm/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1506)),"/Users/iongonta/Downloads/taxflow-crm/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/iongonta/Downloads/taxflow-crm/app/(app)/import/page.tsx"],x="/(app)/import/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(app)/import/page",pathname:"/import",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7635:(e,t,s)=>{Promise.resolve().then(s.bind(s,1165))},5029:(e,t,s)=>{Promise.resolve().then(s.bind(s,5999))},4315:(e,t,s)=>{Promise.resolve().then(s.bind(s,2899))},3324:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},1165:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var r=s(326),a=s(7577),i=s(2945),n=s(5999);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(2881).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var o=s(3685),c=s(9669);let d=["Meta Ads","WhatsApp","Organic","Referință","Site web","Import"],x=`name,company,phone,email,source,note
Ion Popescu,TaxFlow SRL,+37360000001,ion@taxflow.md,Meta Ads,Client nou
Maria Ionescu,ABC SRL,+37360000002,maria@abc.md,Referință,Referit de Ion`;function p(){let[e,t]=(0,a.useState)("upload"),[s,p]=(0,a.useState)([]),[m,h]=(0,a.useState)([]),[u,f]=(0,a.useState)("Import"),[g,b]=(0,a.useState)(!1),[v,j]=(0,a.useState)(!1);function y(e){if(!e.name.endsWith(".csv")){n.A.error("Doar fișiere CSV");return}let s=new FileReader;s.onload=e=>{let s=function(e){let t=e.trim().split("\n").filter(Boolean);if(t.length<2)return[];let s=t[0].split(",").map(e=>e.trim().toLowerCase().replace(/"/g,""));return t.slice(1).map(e=>{let t=e.split(",").map(e=>e.trim().replace(/"/g,"")),r={};return s.forEach((e,s)=>{r[e]=t[s]||""}),{name:r.name||r.nume||"",company:r.company||r.companie||"",phone:r.phone||r.telefon||"",email:r.email||"",source:r.source||r.sursa||u,note:r.note||r.nota||r.notă||""}}).filter(e=>e.name)}(e.target?.result);if(0===s.length){n.A.error("CSV invalid sau gol");return}p(s),t("preview")},s.readAsText(e)}async function N(){b(!0);let e=(0,i.e)(),{data:{user:r}}=await e.auth.getUser(),a=[];for(let t of s){let{error:s}=await e.from("leads").insert({name:t.name,company:t.company||null,phone:t.phone||null,email:t.email||null,source:d.includes(t.source||"")?t.source:"Import",note:t.note||null,status:"Nou",assigned_to:r?.id,created_by:r?.id});a.push({...t,ok:!s,error:s?.message})}h(a),t("done"),b(!1);let l=a.filter(e=>e.ok).length,o=a.filter(e=>!e.ok).length;0===o?n.A.success(`${l} lead-uri importate cu succes!`):n.A.error(`${l} importate, ${o} erori`)}return(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 h-14 flex items-center justify-between flex-shrink-0",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-base font-semibold",children:"Import lead-uri"}),r.jsx("p",{className:"text-xs text-gray-400",children:"Importă din CSV"})]}),(0,r.jsxs)("button",{onClick:function(){let e=new Blob([x],{type:"text/csv"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="taxflow-import-template.csv",t.click()},className:"btn-outline text-xs",children:[r.jsx(l,{size:14}),"Template CSV"]})]}),r.jsx("div",{className:"flex-1 overflow-auto p-6",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:["upload"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-[#e8f0ee] border border-[#c2d9d3] rounded-xl p-4 text-sm text-[#004437]",children:[r.jsx("p",{className:"font-semibold mb-2",children:"\uD83D\uDCCB Format CSV acceptat:"}),r.jsx("code",{className:"text-xs bg-white/60 rounded px-2 py-1 block",children:"name, company, phone, email, source, note"}),(0,r.jsxs)("p",{className:"mt-2 text-xs text-[#004437]/70",children:["Coloana ",r.jsx("strong",{children:"name"})," este obligatorie. Descarcă template-ul pentru exemplu."]})]}),(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("label",{className:"label",children:"Sursă implicită (dacă lipsește din CSV)"}),r.jsx("select",{className:"input w-48",value:u,onChange:e=>f(e.target.value),children:d.map(e=>r.jsx("option",{children:e},e))})]}),(0,r.jsxs)("div",{onDragOver:e=>{e.preventDefault(),j(!0)},onDragLeave:()=>j(!1),onDrop:function(e){e.preventDefault(),j(!1);let t=e.dataTransfer.files[0];t&&y(t)},className:`border-2 border-dashed rounded-xl p-12 text-center transition-all cursor-pointer ${v?"border-[#004437] bg-[#e8f0ee]":"border-gray-300 hover:border-[#004437] hover:bg-gray-50"}`,onClick:()=>document.getElementById("csvInput")?.click(),children:[r.jsx(o.Z,{size:32,className:"mx-auto text-gray-400 mb-3"}),r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Trage fișierul CSV aici"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"sau click pentru a selecta"}),r.jsx("input",{id:"csvInput",type:"file",accept:".csv",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&y(t)}})]})]}),"preview"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:[s.length," lead-uri găsite"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>t("upload"),className:"btn-ghost text-xs",children:"← \xcenapoi"}),r.jsx("button",{onClick:N,disabled:g,className:"btn-primary text-xs",children:g?"Se importă...":"Importă "+s.length+" lead-uri →"})]})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden",children:[(0,r.jsxs)("table",{className:"w-full text-xs",children:[r.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:r.jsx("tr",{children:["Nume","Companie","Telefon","Email","Sursă"].map(e=>r.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-500",children:e},e))})}),r.jsx("tbody",{className:"divide-y divide-gray-100",children:s.slice(0,50).map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-3 py-2 font-medium text-gray-900",children:e.name}),r.jsx("td",{className:"px-3 py-2 text-gray-500",children:e.company||"—"}),r.jsx("td",{className:"px-3 py-2 text-gray-500",children:e.phone||"—"}),r.jsx("td",{className:"px-3 py-2 text-gray-500",children:e.email||"—"}),r.jsx("td",{className:"px-3 py-2",children:r.jsx("span",{className:"bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full",children:e.source||u})})]},t))})]}),s.length>50&&(0,r.jsxs)("div",{className:"px-4 py-2 bg-amber-50 text-xs text-amber-700 border-t border-amber-100",children:["Afișate 50 din ",s.length," r\xe2nduri. Toate vor fi importate."]})]})]}),"done"===e&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"bg-[#e8f0ee] rounded-xl p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-[#004437]",children:m.length}),r.jsx("div",{className:"text-xs text-[#004437]/70 mt-0.5",children:"Total procesate"})]}),(0,r.jsxs)("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.filter(e=>e.ok).length}),r.jsx("div",{className:"text-xs text-green-600/70 mt-0.5",children:"Importate cu succes"})]}),(0,r.jsxs)("div",{className:"bg-red-50 rounded-xl p-4 text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-red-500",children:m.filter(e=>!e.ok).length}),r.jsx("div",{className:"text-xs text-red-500/70 mt-0.5",children:"Erori"})]})]}),m.filter(e=>!e.ok).length>0&&(0,r.jsxs)("div",{className:"bg-white border border-red-200 rounded-xl overflow-hidden",children:[r.jsx("div",{className:"px-4 py-2 bg-red-50 border-b border-red-200 text-xs font-semibold text-red-600",children:"R\xe2nduri cu erori"}),m.filter(e=>!e.ok).map((e,t)=>(0,r.jsxs)("div",{className:"px-4 py-2 border-b border-gray-100 last:border-0 flex items-center gap-2 text-xs",children:[r.jsx(c.Z,{size:13,className:"text-red-500 flex-shrink-0"}),r.jsx("span",{className:"font-medium text-gray-800",children:e.name}),r.jsx("span",{className:"text-red-500",children:e.error})]},t))]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{t("upload"),p([]),h([])},className:"btn-outline",children:"Import nou"}),r.jsx("a",{href:"/contacts",className:"btn-primary",children:"Mergi la Contacte →"})]})]})]})})]})}},2899:(e,t,s)=>{"use strict";s.d(t,{default:()=>j});var r=s(326),a=s(434),i=s(5047),n=s(2945),l=s(4319),o=s(3468),c=s(4061),d=s(1383),x=s(7358),p=s(9730),m=s(3685),h=s(763),u=s(1810),f=s(5999),g=s(1135);let b=[{label:"Dashboard",href:"/dashboard",icon:l.Z},{label:"Pipeline",href:"/pipeline",icon:o.Z},{label:"Contacte",href:"/contacts",icon:c.Z},{label:"Sarcini",href:"/tasks",icon:d.Z},{label:"Evenimente",href:"/events",icon:x.Z},{label:"WhatsApp",href:"/whatsapp",icon:p.Z},{label:"Import",href:"/import",icon:m.Z}],v=[{label:"Echipă & Utilizatori",href:"/admin/users",icon:h.Z}];function j({profile:e}){let t=(0,i.usePathname)(),s=(0,i.useRouter)(),a="admin"===e.role,l=e.full_name.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase();async function o(){let e=(0,n.e)();await e.auth.signOut(),f.A.success("La revedere!"),s.push("/auth/login"),s.refresh()}return a&&[...b,...v],(0,r.jsxs)("aside",{className:"w-[220px] min-w-[220px] bg-[#002e25] flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"px-5 py-5 border-b border-white/[0.08]",children:[r.jsx("div",{className:"font-serif text-xl text-white tracking-tight",children:"TaxFlow"}),r.jsx("div",{className:"text-[10px] text-white/40 uppercase tracking-[1.5px] mt-0.5",children:"CRM \xb7 Partner financiar"})]}),(0,r.jsxs)("nav",{className:"flex-1 px-2.5 py-4 overflow-y-auto scrollbar-thin space-y-0.5",children:[r.jsx("p",{className:"text-[10px] uppercase tracking-[1.2px] text-white/30 font-medium px-2.5 py-2",children:"Principal"}),b.slice(0,3).map(e=>r.jsx(y,{...e,active:t.startsWith(e.href)},e.href)),r.jsx("p",{className:"text-[10px] uppercase tracking-[1.2px] text-white/30 font-medium px-2.5 py-2 mt-2",children:"Activitate"}),b.slice(3,5).map(e=>r.jsx(y,{...e,active:t.startsWith(e.href)},e.href)),r.jsx("p",{className:"text-[10px] uppercase tracking-[1.2px] text-white/30 font-medium px-2.5 py-2 mt-2",children:"Instrumente"}),b.slice(5).map(e=>r.jsx(y,{...e,active:t.startsWith(e.href)},e.href)),a&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("p",{className:"text-[10px] uppercase tracking-[1.2px] text-white/30 font-medium px-2.5 py-2 mt-2",children:"Administrare"}),v.map(e=>r.jsx(y,{...e,active:t.startsWith(e.href)},e.href))]})]}),(0,r.jsxs)("div",{className:"px-4 py-3.5 border-t border-white/[0.08] flex items-center gap-2.5",children:[r.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white flex-shrink-0",style:{background:e.avatar_color},children:l}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"text-[13px] text-white font-medium truncate",children:e.full_name}),r.jsx("div",{className:"text-[11px] text-white/40 truncate",children:a?"⚡ Administrator":"Utilizator"})]}),r.jsx("div",{className:"flex items-center gap-1",children:r.jsx("button",{onClick:o,className:"text-white/40 hover:text-white/80 transition-colors p-1",title:"Ieșire",children:r.jsx(u.Z,{size:15})})})]})]})}function y({href:e,label:t,icon:s,active:i}){return(0,r.jsxs)(a.default,{href:e,className:(0,g.Z)("flex items-center gap-2.5 px-2.5 py-2 rounded-lg text-[13.5px] transition-all",i?"bg-[#00c48c]/15 text-[#00c48c] font-medium":"text-white/60 hover:bg-white/[0.07] hover:text-white"),children:[r.jsx(s,{size:16,className:"flex-shrink-0"}),t]})}},2945:(e,t,s)=>{"use strict";s.d(t,{e:()=>a});var r=s(861);function a(){return(0,r.createBrowserClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},9669:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(2881).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1791:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=s(8570);let a=(0,r.createProxy)(String.raw`/Users/iongonta/Downloads/taxflow-crm/app/(app)/import/page.tsx`),{__esModule:i,$$typeof:n}=a;a.default;let l=(0,r.createProxy)(String.raw`/Users/iongonta/Downloads/taxflow-crm/app/(app)/import/page.tsx#default`)},3703:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(9510),a=s(8585),i=s(9692),n=s(8570);let l=(0,n.createProxy)(String.raw`/Users/iongonta/Downloads/taxflow-crm/components/layout/Sidebar.tsx`),{__esModule:o,$$typeof:c}=l;l.default;let d=(0,n.createProxy)(String.raw`/Users/iongonta/Downloads/taxflow-crm/components/layout/Sidebar.tsx#default`);async function x({children:e}){let t=(0,i.e)(),{data:{user:s}}=await t.auth.getUser();s||(0,a.redirect)("/auth/login");let{data:n}=await t.from("profiles").select("id, full_name, email, role, is_active, avatar_color").eq("id",s.id).single();return n?.is_active||(0,a.redirect)("/auth/login?error=account_disabled"),(0,r.jsxs)("div",{className:"flex h-screen overflow-hidden bg-gray-50",children:[r.jsx(d,{profile:n}),r.jsx("main",{className:"flex-1 flex flex-col overflow-hidden",children:e})]})}},1506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>i});var r=s(9510),a=s(1032);s(7272);let i={title:"TaxFlow CRM",description:"Partner \xeen structurare financiară"};function n({children:e}){return(0,r.jsxs)("html",{lang:"ro",children:[(0,r.jsxs)("head",{children:[r.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),r.jsx("link",{href:"https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&family=DM+Serif+Display:ital@0;1&display=swap",rel:"stylesheet"})]}),(0,r.jsxs)("body",{className:"bg-gray-50 text-gray-900 antialiased",children:[e,r.jsx(a.x7,{position:"bottom-right",richColors:!0})]})]})}},9692:(e,t,s)=>{"use strict";s.d(t,{e:()=>i});var r=s(7721),a=s(1615);function i(){let e=(0,a.cookies)();return(0,r.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:s,options:r})=>e.set(t,s,r))}catch{}}}})}},7272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,786,702,172,334,748],()=>s(8525));module.exports=r})();