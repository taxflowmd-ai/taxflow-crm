(()=>{var e={};e.id=759,e.ids=[759],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3023:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>c}),s(5408),s(3703),s(5866),s(1506);var a=s(3191),n=s(8716),l=s(7922),r=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["(app)",{children:["contacts",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5408)),"/Users/iongonta/Downloads/taxflow-crm/app/(app)/contacts/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3703)),"/Users/iongonta/Downloads/taxflow-crm/app/(app)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,1506)),"/Users/iongonta/Downloads/taxflow-crm/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/iongonta/Downloads/taxflow-crm/app/(app)/contacts/page.tsx"],x="/(app)/contacts/page",p={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(app)/contacts/page",pathname:"/contacts",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},7117:(e,t,s)=>{Promise.resolve().then(s.bind(s,5807))},5807:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(326),n=s(7577),l=s(2945),r=s(5999),i=s(3855),o=s(8307),c=s(9730),d=s(6079);let x={Nou:"#94a3b8",Contactat:"#3a7bd5","\xcent\xe2lnire programată":"#c9a84c","Ofertă trimisă":"#8b5cf6","Client activ":"#00c48c",Pierdut:"#e05050"},p={"Meta Ads":"bg-blue-100 text-blue-700",WhatsApp:"bg-green-100 text-green-700",Organic:"bg-emerald-100 text-emerald-700",Referință:"bg-purple-100 text-purple-700","Site web":"bg-sky-100 text-sky-700",Import:"bg-gray-100 text-gray-600"};function u(){let[e,t]=(0,n.useState)([]),[s,u]=(0,n.useState)([]),[m,h]=(0,n.useState)(""),[g,b]=(0,n.useState)(""),[j,f]=(0,n.useState)(""),[y,v]=(0,n.useState)(!1),[N,w]=(0,n.useState)(!0),[_,C]=(0,n.useState)([]),[S,k]=(0,n.useState)(!1),[P,A]=(0,n.useState)({name:"",company:"",phone:"",email:"",source:"Meta Ads",assigned_to:"",note:""}),[q,D]=(0,n.useState)(null);async function M(){let e=(0,l.e)(),{data:{user:s}}=await e.auth.getUser(),{data:a}=await e.from("profiles").select("role").eq("id",s.id).single(),n=a?.role==="admin";k(n);let{data:r}=await e.from("leads").select("*, assignee:assigned_to(id,full_name,avatar_color)").order("created_at",{ascending:!1}),{data:i}=n?await e.from("profiles").select("id,full_name,avatar_color").eq("is_active",!0):{data:[]};t(r||[]),u(r||[]),C(i||[]),w(!1)}async function U(e){e.preventDefault();let t=(0,l.e)(),{data:{user:s}}=await t.auth.getUser(),a={name:P.name,company:P.company||null,phone:P.phone||null,email:P.email||null,source:P.source,note:P.note||null,status:"Nou",assigned_to:P.assigned_to||s?.id,created_by:s?.id},{error:n}=await t.from("leads").insert(a);if(n){r.A.error(n.message);return}r.A.success("Contact adăugat"),v(!1),A({name:"",company:"",phone:"",email:"",source:"Meta Ads",assigned_to:"",note:""}),M()}let R=(e,t)=>({value:P[e],onChange:t=>A(s=>({...s,[e]:t.target.value})),className:"input",...t});return(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 h-14 flex items-center justify-between flex-shrink-0",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-base font-semibold",children:"Contacte"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:[s.length," din ",e.length]})]}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"btn-primary",children:[a.jsx(i.Z,{size:15}),"Contact nou"]})]}),(0,a.jsxs)("div",{className:"bg-white border-b border-gray-100 px-6 py-2 flex items-center gap-3 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 border border-gray-200 rounded-lg px-3 py-1.5 w-64",children:[a.jsx(o.Z,{size:14,className:"text-gray-400"}),a.jsx("input",{className:"bg-transparent text-sm outline-none flex-1 placeholder:text-gray-400",placeholder:"Caută...",value:m,onChange:e=>h(e.target.value)})]}),(0,a.jsxs)("select",{className:"input w-44 py-1.5",value:g,onChange:e=>b(e.target.value),children:[a.jsx("option",{value:"",children:"Toate statusurile"}),["Nou","Contactat","\xcent\xe2lnire programată","Ofertă trimisă","Client activ","Pierdut"].map(e=>a.jsx("option",{children:e},e))]}),(0,a.jsxs)("select",{className:"input w-36 py-1.5",value:j,onChange:e=>f(e.target.value),children:[a.jsx("option",{value:"",children:"Toate sursele"}),["Meta Ads","WhatsApp","Organic","Referință","Site web","Import"].map(e=>a.jsx("option",{children:e},e))]})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto",children:[N?a.jsx("div",{className:"flex items-center justify-center h-40 text-gray-400 text-sm",children:"Se \xeencarcă..."}):(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsx("tr",{children:["Contact","Telefon","Email","Sursă","Status","Responsabil","Acțiuni"].map(e=>a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wide border-b border-gray-200",children:e},e))})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:s.map(e=>{let t=e.name.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase(),s=e.assignee?.avatar_color||"#3a7bd5",n=x[e.status]||"#94a3b8";return(0,a.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>D(e.id),children:[a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white flex-shrink-0",style:{background:s},children:t}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),a.jsx("div",{className:"text-xs text-gray-400",children:e.company||"—"})]})]})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("a",{href:`tel:${e.phone}`,className:"text-sm text-[#004437] hover:underline",children:e.phone||"—"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:e.email||"—"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded-full ${p[e.source]||"bg-gray-100 text-gray-600"}`,children:e.source})}),a.jsx("td",{className:"px-4 py-3",children:(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium",style:{background:n+"22",color:n},children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full",style:{background:n}}),e.status]})}),a.jsx("td",{className:"px-4 py-3",children:e.assignee&&a.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-[10px] font-bold text-white",style:{background:e.assignee.avatar_color},title:e.assignee.full_name,children:e.assignee.full_name.split(" ").map(e=>e[0]).join("").substring(0,2)})}),a.jsx("td",{className:"px-4 py-3",children:e.phone&&a.jsx("a",{href:`https://wa.me/${e.phone.replace(/\D/g,"")}`,target:"_blank",className:"p-1.5 rounded-lg border border-gray-200 text-green-600 hover:bg-green-50 transition-colors inline-flex",children:a.jsx(c.Z,{size:13})})})]},e.id)})})]}),!N&&0===s.length&&(0,a.jsxs)("div",{className:"text-center py-16 text-gray-400",children:[a.jsx("div",{className:"text-3xl mb-2",children:"\uD83D\uDD0D"}),a.jsx("p",{className:"text-sm",children:"Niciun contact găsit"})]})]}),a.jsx(d.Z,{leadId:q,onClose:()=>{D(null),M()},team:_,isAdmin:S}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"font-semibold",children:"Contact nou"}),a.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 text-xl",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:U,className:"px-6 py-4 space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Nume *"}),a.jsx("input",{...R("name"),required:!0,placeholder:"Ion Popescu"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Companie"}),a.jsx("input",{...R("company"),placeholder:"SRL..."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Telefon"}),a.jsx("input",{...R("phone"),placeholder:"+373..."})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Email"}),a.jsx("input",{...R("email"),type:"email"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Sursă"}),a.jsx("select",{...R("source"),className:"input",children:["Meta Ads","WhatsApp","Organic","Referință","Site web"].map(e=>a.jsx("option",{children:e},e))})]}),S&&_.length>0&&(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Responsabil"}),(0,a.jsxs)("select",{...R("assigned_to"),className:"input",children:[a.jsx("option",{value:"",children:"— eu —"}),_.map(e=>a.jsx("option",{value:e.id,children:e.full_name},e.id))]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"label",children:"Notă"}),a.jsx("textarea",{...R("note"),className:"input resize-none",rows:2})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx("button",{type:"button",onClick:()=>v(!1),className:"btn-ghost",children:"Anulează"}),a.jsx("button",{type:"submit",className:"btn-primary",children:"Adaugă"})]})]})]})})]})}},8307:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(2881).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},5408:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>l,default:()=>i});var a=s(8570);let n=(0,a.createProxy)(String.raw`/Users/iongonta/Downloads/taxflow-crm/app/(app)/contacts/page.tsx`),{__esModule:l,$$typeof:r}=n;n.default;let i=(0,a.createProxy)(String.raw`/Users/iongonta/Downloads/taxflow-crm/app/(app)/contacts/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,786,702,172,334,748,701],()=>s(3023));module.exports=a})();