(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{3778:function(e,s,a){Promise.resolve().then(a.bind(a,9731))},9731:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return m}});var t=a(7437),l=a(2265),n=a(6474),r=a(7776),i=a(2513),c=a(4817),d=a(7583),o=a(3672);let x={Nou:"#94a3b8",Contactat:"#3a7bd5","\xcent\xe2lnire programată":"#c9a84c","Ofertă trimisă":"#8b5cf6","Client activ":"#00c48c",Pierdut:"#e05050"},u={"Meta Ads":"bg-blue-100 text-blue-700",WhatsApp:"bg-green-100 text-green-700",Organic:"bg-emerald-100 text-emerald-700",Referință:"bg-purple-100 text-purple-700","Site web":"bg-sky-100 text-sky-700",Import:"bg-gray-100 text-gray-600"};function m(){let[e,s]=(0,l.useState)([]),[a,m]=(0,l.useState)([]),[p,h]=(0,l.useState)(""),[g,j]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),[y,N]=(0,l.useState)(!1),[v,w]=(0,l.useState)(!0),[C,_]=(0,l.useState)([]),[k,S]=(0,l.useState)(!1),[A,D]=(0,l.useState)({name:"",company:"",phone:"",email:"",source:"Meta Ads",assigned_to:"",note:""}),[E,L]=(0,l.useState)(null);async function O(){let e=(0,n.e)(),{data:{user:a}}=await e.auth.getUser(),{data:t}=await e.from("profiles").select("role").eq("id",a.id).single(),l=(null==t?void 0:t.role)==="admin";S(l);let{data:r}=await e.from("leads").select("*, assignee:assigned_to(id,full_name,avatar_color)").order("created_at",{ascending:!1}),{data:i}=l?await e.from("profiles").select("id,full_name,avatar_color").eq("is_active",!0):{data:[]};s(r||[]),m(r||[]),_(i||[]),w(!1)}async function z(e){e.preventDefault();let s=(0,n.e)(),{data:{user:a}}=await s.auth.getUser(),t={name:A.name,company:A.company||null,phone:A.phone||null,email:A.email||null,source:A.source,note:A.note||null,status:"Nou",assigned_to:A.assigned_to||(null==a?void 0:a.id),created_by:null==a?void 0:a.id},{error:l}=await s.from("leads").insert(t);if(l){r.A.error(l.message);return}r.A.success("Contact adăugat"),N(!1),D({name:"",company:"",phone:"",email:"",source:"Meta Ads",assigned_to:"",note:""}),O()}(0,l.useEffect)(()=>{O()},[]),(0,l.useEffect)(()=>{let s=e;p&&(s=s.filter(e=>{var s;return(null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes(p.toLowerCase()))||(e.phone||"").includes(p)||(e.company||"").toLowerCase().includes(p.toLowerCase())||(e.email||"").toLowerCase().includes(p.toLowerCase())})),g&&(s=s.filter(e=>e.status===g)),b&&(s=s.filter(e=>e.source===b)),m(s)},[p,g,b,e]);let R=(e,s)=>({value:A[e],onChange:s=>D(a=>({...a,[e]:s.target.value})),className:"input",...s});return(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 h-14 flex items-center justify-between flex-shrink-0",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-base font-semibold",children:"Contacte"}),(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:[a.length," din ",e.length]})]}),(0,t.jsxs)("button",{onClick:()=>N(!0),className:"btn-primary",children:[(0,t.jsx)(i.Z,{size:15}),"Contact nou"]})]}),(0,t.jsxs)("div",{className:"bg-white border-b border-gray-100 px-6 py-2 flex items-center gap-3 flex-shrink-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-gray-50 border border-gray-200 rounded-lg px-3 py-1.5 w-64",children:[(0,t.jsx)(c.Z,{size:14,className:"text-gray-400"}),(0,t.jsx)("input",{className:"bg-transparent text-sm outline-none flex-1 placeholder:text-gray-400",placeholder:"Caută...",value:p,onChange:e=>h(e.target.value)})]}),(0,t.jsxs)("select",{className:"input w-44 py-1.5",value:g,onChange:e=>j(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Toate statusurile"}),["Nou","Contactat","\xcent\xe2lnire programată","Ofertă trimisă","Client activ","Pierdut"].map(e=>(0,t.jsx)("option",{children:e},e))]}),(0,t.jsxs)("select",{className:"input w-36 py-1.5",value:b,onChange:e=>f(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Toate sursele"}),["Meta Ads","WhatsApp","Organic","Referință","Site web","Import"].map(e=>(0,t.jsx)("option",{children:e},e))]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-auto",children:[v?(0,t.jsx)("div",{className:"flex items-center justify-center h-40 text-gray-400 text-sm",children:"Se \xeencarcă..."}):(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50 sticky top-0",children:(0,t.jsx)("tr",{children:["Contact","Telefon","Email","Sursă","Status","Responsabil","Acțiuni"].map(e=>(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wide border-b border-gray-200",children:e},e))})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-100",children:a.map(e=>{var s;let a=e.name.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase(),l=(null===(s=e.assignee)||void 0===s?void 0:s.avatar_color)||"#3a7bd5",n=x[e.status]||"#94a3b8";return(0,t.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>L(e.id),children:[(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white flex-shrink-0",style:{background:l},children:a}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:e.company||"—"})]})]})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("a",{href:"tel:".concat(e.phone),className:"text-sm text-[#004437] hover:underline",children:e.phone||"—"})}),(0,t.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:e.email||"—"}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full ".concat(u[e.source]||"bg-gray-100 text-gray-600"),children:e.source})}),(0,t.jsx)("td",{className:"px-4 py-3",children:(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium",style:{background:n+"22",color:n},children:[(0,t.jsx)("span",{className:"w-1.5 h-1.5 rounded-full",style:{background:n}}),e.status]})}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.assignee&&(0,t.jsx)("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-[10px] font-bold text-white",style:{background:e.assignee.avatar_color},title:e.assignee.full_name,children:e.assignee.full_name.split(" ").map(e=>e[0]).join("").substring(0,2)})}),(0,t.jsx)("td",{className:"px-4 py-3",children:e.phone&&(0,t.jsx)("a",{href:"https://wa.me/".concat(e.phone.replace(/\D/g,"")),target:"_blank",className:"p-1.5 rounded-lg border border-gray-200 text-green-600 hover:bg-green-50 transition-colors inline-flex",children:(0,t.jsx)(d.Z,{size:13})})})]},e.id)})})]}),!v&&0===a.length&&(0,t.jsxs)("div",{className:"text-center py-16 text-gray-400",children:[(0,t.jsx)("div",{className:"text-3xl mb-2",children:"\uD83D\uDD0D"}),(0,t.jsx)("p",{className:"text-sm",children:"Niciun contact găsit"})]})]}),(0,t.jsx)(o.Z,{leadId:E,onClose:()=>{L(null),O()},team:C,isAdmin:k}),y&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"font-semibold",children:"Contact nou"}),(0,t.jsx)("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600 text-xl",children:"\xd7"})]}),(0,t.jsxs)("form",{onSubmit:z,className:"px-6 py-4 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Nume *"}),(0,t.jsx)("input",{...R("name"),required:!0,placeholder:"Ion Popescu"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Companie"}),(0,t.jsx)("input",{...R("company"),placeholder:"SRL..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Telefon"}),(0,t.jsx)("input",{...R("phone"),placeholder:"+373..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Email"}),(0,t.jsx)("input",{...R("email"),type:"email"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Sursă"}),(0,t.jsx)("select",{...R("source"),className:"input",children:["Meta Ads","WhatsApp","Organic","Referință","Site web"].map(e=>(0,t.jsx)("option",{children:e},e))})]}),k&&C.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Responsabil"}),(0,t.jsxs)("select",{...R("assigned_to"),className:"input",children:[(0,t.jsx)("option",{value:"",children:"— eu —"}),C.map(e=>(0,t.jsx)("option",{value:e.id,children:e.full_name},e.id))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"label",children:"Notă"}),(0,t.jsx)("textarea",{...R("note"),className:"input resize-none",rows:2})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>N(!1),className:"btn-ghost",children:"Anulează"}),(0,t.jsx)("button",{type:"submit",className:"btn-primary",children:"Adaugă"})]})]})]})})]})}},4817:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,a(8030).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])}},function(e){e.O(0,[46,776,155,971,23,744],function(){return e(e.s=3778)}),_N_E=e.O()}]);