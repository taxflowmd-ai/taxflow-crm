(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[468],{5105:function(e,t,s){Promise.resolve().then(s.bind(s,3940))},3940:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var a=s(7437),l=s(2265),n=s(6474),i=s(7776),r=s(2513);let d={meeting:{label:"\xcent\xe2lnire",icon:"\uD83E\uDD1D",cls:"bg-blue-50 text-blue-700"},call:{label:"Apel",icon:"\uD83D\uDCDE",cls:"bg-green-50 text-green-700"},deadline:{label:"Deadline",icon:"⏰",cls:"bg-red-50 text-red-600"}},c=["Ianuarie","Februarie","Martie","Aprilie","Mai","Iunie","Iulie","August","Septembrie","Octombrie","Noiembrie","Decembrie"],o=["L","M","M","J","V","S","D"];function x(){let[e,t]=(0,l.useState)([]),[s,x]=(0,l.useState)([]),[u,m]=(0,l.useState)(!1),[h,b]=(0,l.useState)({y:new Date().getFullYear(),m:new Date().getMonth()}),[g,p]=(0,l.useState)({title:"",type:"meeting",lead_id:"",starts_at:"",location:"",note:""});async function j(){let e=(0,n.e)(),{data:s}=await e.from("events").select("*, lead:lead_id(name)").order("starts_at"),{data:a}=await e.from("leads").select("id,name").order("name");t(s||[]),x(a||[])}async function v(e){e.preventDefault();let t=(0,n.e)(),{data:{user:s}}=await t.auth.getUser(),a={title:g.title,type:g.type,lead_id:g.lead_id||null,starts_at:g.starts_at,location:g.location||null,note:g.note||null,assigned_to:null==s?void 0:s.id,created_by:null==s?void 0:s.id},{error:l}=await t.from("events").insert(a);if(l){i.A.error(l.message);return}i.A.success("Eveniment adăugat"),m(!1),p({title:"",type:"meeting",lead_id:"",starts_at:"",location:"",note:""}),j()}(0,l.useEffect)(()=>{j()},[]);let f=new Set(e.map(e=>new Date(e.starts_at).toDateString())),y=new Date,N=new Date(h.y,h.m,1).getDay(),D=new Date(h.y,h.m+1,0).getDate(),w=0===N?6:N-1,_=Array.from({length:w},(e,t)=>({d:0,i:t})).concat(Array.from({length:D},(e,t)=>({d:t+1,i:t+w}))),S=e.filter(e=>new Date(e.starts_at)>=y).slice(0,20),C=e=>({value:g[e],onChange:t=>p(s=>({...s,[e]:t.target.value})),className:"input"});return(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 h-14 flex items-center justify-between flex-shrink-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-base font-semibold",children:"Evenimente"}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:[S.length," viitoare"]})]}),(0,a.jsxs)("button",{onClick:()=>m(!0),className:"btn-primary",children:[(0,a.jsx)(r.Z,{size:15}),"Eveniment nou"]})]}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_280px] gap-6 items-start",children:[(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-100 text-sm font-semibold text-gray-900",children:"Upcoming"}),S.map(e=>{var t;let s=d[e.type]||d.meeting,l=new Date(e.starts_at);return(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100 last:border-0 flex items-center gap-4 hover:bg-gray-50",children:[(0,a.jsxs)("div",{className:"text-center w-12 flex-shrink-0",children:[(0,a.jsx)("div",{className:"text-xs font-bold text-[#004437]",children:l.toLocaleTimeString("ro-RO",{hour:"2-digit",minute:"2-digit"})}),(0,a.jsx)("div",{className:"text-[10px] text-gray-400",children:l.toLocaleDateString("ro-RO",{day:"2-digit",month:"short"})})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:[(null===(t=e.lead)||void 0===t?void 0:t.name)&&"\uD83D\uDC64 "+e.lead.name,e.location&&" \xb7 \uD83D\uDCCD"+e.location]})]}),(0,a.jsxs)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full ".concat(s.cls),children:[s.icon," ",s.label]})]},e.id)}),0===S.length&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-400 text-sm",children:"Niciun eveniment viitor"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("button",{onClick:()=>b(e=>{let t=e.m-1,s=e.y;return t<0&&(t=11,s--),{y:s,m:t}}),className:"w-7 h-7 border border-gray-200 rounded-lg flex items-center justify-center text-gray-500 hover:bg-gray-50",children:"‹"}),(0,a.jsxs)("span",{className:"text-sm font-semibold",children:[c[h.m]," ",h.y]}),(0,a.jsx)("button",{onClick:()=>b(e=>{let t=e.m+1,s=e.y;return t>11&&(t=0,s++),{y:s,m:t}}),className:"w-7 h-7 border border-gray-200 rounded-lg flex items-center justify-center text-gray-500 hover:bg-gray-50",children:"›"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-0.5",children:[o.map((e,t)=>(0,a.jsx)("div",{className:"text-center text-[10px] font-semibold text-gray-400 py-1",children:e},t)),_.map(e=>{let{d:t,i:s}=e;if(!t)return(0,a.jsx)("div",{},s);let l=new Date(h.y,h.m,t),n=l.toDateString()===y.toDateString(),i=f.has(l.toDateString());return(0,a.jsxs)("div",{className:"relative text-center text-xs py-1.5 rounded-lg ".concat(n?"bg-[#004437] text-white font-bold":"text-gray-700 hover:bg-gray-50"),children:[t,i&&(0,a.jsx)("span",{className:"absolute bottom-0.5 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full ".concat(n?"bg-white/70":"bg-[#00c48c]")})]},s)})]})]})]})}),u&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"font-semibold",children:"Eveniment nou"}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 text-xl",children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:v,className:"px-6 py-4 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Titlu *"}),(0,a.jsx)("input",{...C("title"),required:!0,placeholder:"\xcent\xe2lnire..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Tip"}),(0,a.jsxs)("select",{...C("type"),className:"input",children:[(0,a.jsx)("option",{value:"meeting",children:"\uD83E\uDD1D \xcent\xe2lnire"}),(0,a.jsx)("option",{value:"call",children:"\uD83D\uDCDE Apel"}),(0,a.jsx)("option",{value:"deadline",children:"⏰ Deadline"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Contact"}),(0,a.jsxs)("select",{...C("lead_id"),className:"input",children:[(0,a.jsx)("option",{value:"",children:"— niciun contact —"}),s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Data și ora *"}),(0,a.jsx)("input",{...C("starts_at"),type:"datetime-local",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Locație"}),(0,a.jsx)("input",{...C("location"),placeholder:"Adresă sau link"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Notă"}),(0,a.jsx)("textarea",{...C("note"),className:"input resize-none",rows:2})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>m(!1),className:"btn-ghost",children:"Anulează"}),(0,a.jsx)("button",{type:"submit",className:"btn-primary",children:"Adaugă"})]})]})]})})]})}},6474:function(e,t,s){"use strict";s.d(t,{e:function(){return n}});var a=s(6038),l=s(357);function n(){return(0,a.createBrowserClient)(l.env.NEXT_PUBLIC_SUPABASE_URL,l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},2513:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(8030).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},function(e){e.O(0,[46,776,971,23,744],function(){return e(e.s=5105)}),_N_E=e.O()}]);