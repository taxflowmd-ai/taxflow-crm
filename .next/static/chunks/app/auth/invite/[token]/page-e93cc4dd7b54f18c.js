(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{806:function(e,t,a){Promise.resolve().then(a.bind(a,3604))},3604:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(7437),r=a(2265),n=a(6463),i=a(6474),l=a(7776),c=a(3274),o=a(1935),u=a(2940),x=a(7019),d=a(5733);function m(e){let{params:t}=e,a=(0,n.useRouter)(),[m,p]=(0,r.useState)("loading"),[f,j]=(0,r.useState)(null),[b,y]=(0,r.useState)(""),[N,v]=(0,r.useState)(""),[g,k]=(0,r.useState)(""),[w,C]=(0,r.useState)(!1),[S,Z]=(0,r.useState)(!1);async function z(e){if(e.preventDefault(),N.length<8){l.A.error("Parola trebuie sa aiba minim 8 caractere");return}if(N!==g){l.A.error("Parolele nu coincid");return}if(!b.trim()){l.A.error("Introdu numele complet");return}Z(!0);try{let e=await fetch("/api/auth/accept-invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t.token,email:f.email,password:N,fullName:b.trim(),role:f.role})}),s=await e.json();if(!e.ok)throw Error(s.error||"Eroare necunoscuta");p("success"),setTimeout(()=>a.push("/auth/login"),2500)}catch(e){l.A.error(e.message),Z(!1)}}return((0,r.useEffect)(()=>{(async function(){let e=(0,i.e)(),{data:a,error:s}=await e.from("invitations").select("email, role, accepted_at, expires_at").eq("token",t.token).single();if(s||!a){p("invalid");return}if(a.accepted_at){p("used");return}if(new Date(a.expires_at)<new Date){p("expired");return}j({email:a.email,role:a.role}),p("valid")})()},[t.token]),"loading"===m)?(0,s.jsx)(h,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsx)(c.Z,{size:32,className:"animate-spin text-[#004437]"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm",children:"Se verifica invitatia..."})]})}):"invalid"===m?(0,s.jsxs)(h,{children:[(0,s.jsx)(o.Z,{size:48,className:"text-red-400 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2 text-center",children:"Link invalid"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm text-center",children:"Acest link de invitatie nu exista sau a fost deja folosit."})]}):"expired"===m?(0,s.jsxs)(h,{children:[(0,s.jsx)(o.Z,{size:48,className:"text-amber-400 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2 text-center",children:"Link expirat"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm text-center",children:"Invitatia a expirat (valabila 7 zile). Solicita o noua invitatie."})]}):"used"===m?(0,s.jsxs)(h,{children:[(0,s.jsx)(u.Z,{size:48,className:"text-green-500 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2 text-center",children:"Deja inregistrat"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm text-center mb-4",children:"Aceasta invitatie a fost deja acceptata."}),(0,s.jsx)("button",{onClick:()=>a.push("/auth/login"),className:"btn-primary mx-auto",children:"Intra in cont"})]}):"success"===m?(0,s.jsxs)(h,{children:[(0,s.jsx)(u.Z,{size:48,className:"text-[#00c48c] mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2 text-center",children:"Cont creat cu succes!"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm text-center",children:"Te redirectionam catre login..."})]}):(0,s.jsx)("div",{className:"min-h-screen bg-[#002e25] flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-sm",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"font-serif text-4xl text-white mb-1",children:"TaxFlow"}),(0,s.jsx)("p",{className:"text-xs text-white/40 uppercase tracking-[2px]",children:"CRM"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-8 pt-8 pb-2",children:[(0,s.jsx)("div",{className:"inline-flex items-center gap-2 bg-[#e8f0ee] text-[#004437] text-xs font-medium px-3 py-1.5 rounded-full mb-4",children:"Invitatie acceptata"}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-1",children:"Creeaza contul tau"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mb-6",children:["Email: ",(0,s.jsx)("span",{className:"font-medium text-gray-700",children:null==f?void 0:f.email})]})]}),(0,s.jsxs)("form",{onSubmit:z,className:"px-8 pb-8 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Nume complet *"}),(0,s.jsx)("input",{type:"text",className:"input",placeholder:"Ion Popescu",value:b,onChange:e=>y(e.target.value),required:!0,autoFocus:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Parola * (minim 8 caractere)"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:w?"text":"password",className:"input pr-10",placeholder:"password",value:N,onChange:e=>v(e.target.value),required:!0,minLength:8}),(0,s.jsx)("button",{type:"button",onClick:()=>C(!w),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:w?(0,s.jsx)(x.Z,{size:16}):(0,s.jsx)(d.Z,{size:16})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Confirma parola *"}),(0,s.jsx)("input",{type:"password",className:"input ".concat(g&&N!==g?"border-red-400":""),placeholder:"password",value:g,onChange:e=>k(e.target.value),required:!0}),g&&N!==g&&(0,s.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"Parolele nu coincid"})]}),(0,s.jsxs)("button",{type:"submit",disabled:S||!b||!N||N!==g,className:"w-full bg-[#004437] text-white py-2.5 rounded-lg text-sm font-semibold hover:bg-[#005a47] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-2",children:[S&&(0,s.jsx)(c.Z,{size:16,className:"animate-spin"}),S?"Se creeaza contul...":"Creeaza contul"]})]})]})]})})}function h(e){let{children:t}=e;return(0,s.jsx)("div",{className:"min-h-screen bg-[#002e25] flex items-center justify-center p-4",children:(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-2xl p-10 w-full max-w-sm",children:t})})}},6474:function(e,t,a){"use strict";a.d(t,{e:function(){return n}});var s=a(6038),r=a(357);function n(){return(0,s.createBrowserClient)(r.env.NEXT_PUBLIC_SUPABASE_URL,r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},2940:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1935:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},7019:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},5733:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},3274:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(8030).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6463:function(e,t,a){"use strict";var s=a(1169);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[46,776,971,23,744],function(){return e(e.s=806)}),_N_E=e.O()}]);